---
title: "newDTS_AM"
output: html_document
date: "2025-10-02"
---

---
title: "DTS"
output: html_document
date: "2025-09-29"
---
1)first things first <3
```{r}
setwd("/Volumes/Hera/Angela/DTS_AM")
library(dplyr)
library(tidyr)
#install.packages("ggcorrplot")
library(ggcorrplot)
library(lubridate)
library(mgcv)
#install.packages("purrr")
#install.packages("nanonext", repos = "https://cloud.r-project.org") #for GAMS
#install.packages("insight") #for ggeffects
#install.packages("patchwork")  # only if not installed
library(patchwork)
```

NOTES:
DISTRESS TOLERANCE SCALE - 15-item self-report measure of emotional distress
ITEM CODING - Individuals select on a 1-5 Likert Scale -- (Strongly Disagree, Mildly Disagree, Feel Neutral, Mildly Agree, Strongly Agree)
REVERSE CODING - There is one total scale and only ITEM 6 is reverse coded

2)GRABBING THE DATA AND MAKING IT EASY TO READ
```{r}
dts <- read.csv('/Volumes/Hera/Projects/7TBrainMech/scripts/behave/txt/dts.csv')
merg7T_raw <- read.csv("/Volumes/Hera/Projects/hippocampal_myelin/sample_info/merge_7t_04172025.csv") %>% 
  select(lunaid, visitno, behave.date)

hr1_demo <- read.csv("/Volumes/Hera/Projects/hippocampal_myelin/output_measures/hippocampal_R1_demographics.csv")

### RENAMING THE COLUMNS TO BE dts1, dts2, ..., dts15 ###
# note: this function renames the columns selected (1-15) #
names(dts)[1:15] <- paste0("dts", 1:15)

### SEPERATING LUNAID AND VISIT DATE (TWO SEPARATE COLUMNS) ###
# was originally 99999_YYYYMMDD # also ld8 was the orignical column name #
dts <- dts %>%
  separate(ld8, into = c("lunaid", "visitdate"), sep = "_")
  
dts <- dts %>%
  mutate(visitdate = as.Date(visitdate, format = "%Y%m%d")) # converting string into date object #
```

3) CREATING A FUNCTION THAT CONVERTS TO 1-5 LIKERT -- TEST CODE AT THE END OF THE CODE BLOCK --
```{r}
dts_num <- function(x){
  x <- as.character(x)
  case_when(
    x %in% c("Strongly disagree", "1") ~ 1,
    x %in% c("Mildly disagree", "2") ~ 2,
    x %in% c("Equally agree and disagree", "3") ~ 3,
    x %in% c("Mildly agree", "4") ~ 4,
    x %in% c("Strongly agree", "5") ~ 5
  )
}
#applying the created function across every column from dts1 to dts15
dts <- dts %>%
  mutate(across(dts1:dts15, dts_num))

rbind(dts$dts15, dts_num(dts$dts15))  #test code - combines two vectors and prints
dts_num(dts$dts15) #test code - prints the converted vector
```

4)FILTERING N/As (new dataframe)
```{r}
### FILTER ROWS THAT HAVE TOO MANY NA ### 
# creating a variable w complete_cases to establish new df that only contains rows where all items are filled in (no NA responses) #
dts_new <- dts |> 
  filter(if_all(dts1:dts15, ~ !is.na(.)))
```

5)SCORING!
```{r}
### INSTRUCTIONS ###
# Raw data items coded 1-5 (with high anchor of very true of me) #
# scales scored so that high scores represent great tolerance #
# THERE ARE FOUR DIFFERENT SUBSCALES: TOLERANCE, ABSORPTION, APPRAISAL, REGULATION # 
# SIMONS & GAHER (2005) --> "Scoring: Item 6 is reverse scored. Subscale scores are the mean of the items.The higher-order DTS is formed from the mean of the four subscales."

### | Subscale   | Items                                      #--------------------------------------------------------------
### | Tolerance  | dts1, dts3, dts5                           |
### | Absorb     | dts2, dts4, dts15                          |
### | Appraisal  | dts6, dts7, dts9, dts10, dts11, dts12  |
### | Regulation | dts8, dts13, dts14                         | 

### REVERSE SCORING ITEM 6 - FUNCTION ###
reverse_score <- function(x, maxscore = 5) {
  return(maxscore + 1 -x )
} # if they answered 1 then it'll reverse to 5, 2 to 4, 3 stays same, 4 to 2, and 5 to 1 #   
  
dts_new <- dts_new %>%
  mutate(
    dts6_rev = reverse_score(dts6))

### SCORING SUBSCALES ###
dts_new <- dts_new %>%
  mutate(
    DTS_Tolerance = rowMeans(select(., dts1, dts3, dts5), na.rm = TRUE),
    DTS_Absorb = rowMeans(select(., dts2, dts4, dts15 ), na.rm = TRUE),
    DTS_Appraise = rowMeans(select(., dts6_rev, dts7, dts9, dts10, dts11, dts12), na.rm = TRUE),
    DTS_Regulate = rowMeans(select(., dts8, dts13, dts14), na.rm = TRUE)
  )

### SCORING TOTAL DTS ###
dts_new <- dts_new %>%
  mutate(
    DTS_Total = rowSums(select(., DTS_Tolerance, DTS_Appraise, DTS_Absorb, DTS_Regulate), na.rm = TRUE))
```

6) MERGING DATASETS
```{r}
# first, convert lunaids as characters for consistency
dts_new$lunaid <- as.character(dts_new$lunaid)
hr1_demo$lunaid <- as.character(hr1_demo$lunaid)
hr1_demo$behave.date <- ymd(hr1_demo$behave.date) #lubridate package (hr1_demo has numbers instead of characters for behave.date)

#rename columns behave.date to visitdate for consistency
#hr1_demo <- hr1_demo %>%
  #rename(visitdate.y = "visidate")

### WELCOME hr1_demo_raw VIA LEFTJOIN ###
dts_hr1 <- left_join(hr1_demo, dts_new, by = "lunaid", "visitdate")
dts_hr1$behave.date <- ymd(dts_hr1$behave.date)

#calculating the difference in days
dts_hr2 <- dts_hr1 %>%
  mutate(date_diff = abs(as.numeric(behave.date - visitdate)))

#assigning closest behavioral visit and its visit.no
dts_hr3 <- dts_hr2 %>%
  group_by(lunaid, visitdate) %>%
  slice_min(order_by = date_diff, n = 1) %>% #selecting rows with the smallest value and take only one single close match (n=1) 
  ungroup()

#removing any duplicated survey responses, only keeping the closest 
dts_hr4 <- dts_hr3 %>% 
  group_by(lunaid, visitno) %>%
  filter(!is.na(visitno)) %>%
  slice_min(order_by = date_diff, n = 1) %>% 
  ungroup()

#recounting distribution
dts_distribution <- dts_hr4 %>%
  filter(!is.na(visitno)) %>%
  count(visitno, name = "n_subs")

#reordering columns
dts_hr4 <- dts_hr4 %>%
    select(lunaid, visitdate, visitno, age, everything())
```

7) SOME BEGINNING VISUALS
```{r}
library(ggplot2) #loading

#convert to long format -- why? each variable is in its own row (ex: Domain and Score) -- ggplot2 requires long format for grouped plots! (e.g., boxplots, bar charts, line plots, etc.)
#note: pivot_longer helps us do this 
dts_long <- dts_hr4 |>
  select(lunaid, visitno, age, DTS_Tolerance:DTS_Regulate) |> 
  pivot_longer(cols = DTS_Tolerance:DTS_Regulate, names_to = "DTS_Domain", values_to = "Score") %>%
  ### AGE GROUPS (HISTOGRAM) ###
  mutate(age_group = cut(age,
                         breaks = c(0, 16, 20, 24, 33), 
                         labels = c("10-15", "16-19", "20-23", "24-32")))

### DOMAIN TRENDS ACROSS TIMEPOINTS (LINE) ###
ggplot(dts_long, aes(x = visitno, y = Score, color = DTS_Domain, group = interaction(DTS_Domain, age_group))) + 
  stat_summary(fun = mean, geom = "line", linewidth = 1) +
  stat_summary(fun = mean, geom = "point", size = 2) + 
  facet_wrap(~ age_group) +
  labs(title = "DTS DOMAIN SCORES OVER TIME",
       x = "Timepoint",
       y = "Score") + 
  theme_classic()

```

8) LINEAR MODELS AND CORRELATION MATRIX
```{r}
### LINEAR REGRESSION MODEL - How does age predict different dts domains? ###
#note: model <- lm(outcome ~ x + y, data = your_dataframe)

model_Tolerance <- lm(DTS_Tolerance ~ age, data = dts_hr4)
summary(model_Tolerance)

model_Absorb <- lm(DTS_Absorb ~ age, data = dts_hr4) 
summary(model_Absorb)

model_Appraise <- lm(DTS_Appraise ~ age, data = dts_hr4) 
summary(model_Appraise)

model_Regulate <- lm(DTS_Regulate ~ age, data = dts_hr4)
summary(model_Regulate)

model_all <- lm(cbind(DTS_Tolerance, DTS_Absorb, DTS_Appraise, DTS_Regulate) ~ age, data = dts_hr4)
summary(model_all)

### DANS FIGURE -- Age negatively prediciting DTS subdomains! ###

#visualize Linear Regression Models 
library(ggplot2)

ggplot(dts_hr4, aes(x = age, y = DTS_Tolerance)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(title = "Age effect on Tolerance Domain", x = "Age", y = "Tolerance Domain Score") +
  theme_classic(base_size = 16, base_family = "Times New Roman") +
  theme(
    plot.title = element_text(face = "bold"),
    axis.title = element_text(face = "bold")
  )

ggplot(dts_hr4, aes(x = age, y = DTS_Absorb)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(title = "Age effect on Absorption Domain", x = "Age", y = "Absorption Domain Score") +
  theme_classic(base_size = 16, base_family = "Times New Roman") +
  theme(
    plot.title = element_text(face = "bold"),
    axis.title = element_text(face = "bold")
  )

ggplot(dts_hr4, aes(x = age, y = DTS_Appraise)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(title = "Age effect on Appraisal Domain", x = "Age", y = "Appraisal Domain Score") +
  theme_classic(base_size = 16, base_family = "Times New Roman") +
  theme(
    plot.title = element_text(face = "bold"),
    axis.title = element_text(face = "bold")
  )

ggplot(dts_hr4, aes(x = age, y = DTS_Regulate)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(title = "Age effect on Regulation Domain", x = "Age", y = "Regulation Domain Score") +
  theme_classic(base_size = 16, base_family = "Times New Roman") +
  theme(
    plot.title = element_text(face = "bold"),
    axis.title = element_text(face = "bold")
  )

### CORRELATION MATRIX OF 4 SUBDOMAINS ###

subscales <- dts_hr4 %>% select(DTS_Tolerance, DTS_Absorb, DTS_Appraise, DTS_Regulate)
DTS.corr <- cor(subscales)
ggcorrplot(DTS.corr)
ggcorrplot(DTS.corr,
           method = "circle",           # shape of the plot elements
           type = "lower",              # show only the lower triangle
           lab = TRUE,                  # show correlation coefficients
           lab_size = 4,
           colors = c("tomato2", "white", "springgreen3"),  # color gradient
           title = "Correlation Matrix of DTS Subscales",
           ggtheme = theme_minimal())

### BASIC MODELING ###
dts_hr4$lunaid <- as.factor(dts_hr4$lunaid)

#Developmental Model: How does R1 change (non-linearly) with age?
gam(lh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re"), method = "REML", data = dts_hr4)
gam(rh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re"), method = "REML", data = dts_hr4)

#Environmental Models: What is the relationship between ADI and R1, controlling for age differences in R1?
gam(lh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + ADI_NATRANK, method = "REML", data = dts_hr4) 
gam(rh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + ADI_NATRANK, method = "REML", data = dts_hr4)

### DANS FIGURE: Raw visualization of ADI -> HPC R1 ###
ggplot(dts_mod, aes(x = ADI_NATRANK, y = rh_hippocampus_R1)) +
  geom_point(alpha = 0.5, color = "#1f78b4") +
  geom_smooth(method = "lm", color = "black", se = TRUE) +
  labs(
    title = "Right Hippocampus",
    x = "Neighborhood Disadvantage (ADI)",
    y = "Hippocampal R₁ value"
  ) +
  theme_classic(base_size = 16, base_family = "Times New Roman") +
  theme(
    plot.title = element_text(face = "bold"),
    axis.title = element_text(face = "bold")
  )

ggplot(dts_mod, aes(x = ADI_NATRANK, y = lh_hippocampus_R1)) +
  geom_point(alpha = 0.5, color = "#1f78b4") +
  geom_smooth(method = "lm", color = "black", se = TRUE) +
  labs(
    title = "Left Hippocampus",
    x = "Neighborhood Disadvantage (ADI)",
    y = "Hippocampal R₁ value"
  ) +
  theme_classic(base_size = 16, base_family = "Times New Roman") +
  theme(
    plot.title = element_text(face = "bold"),
    axis.title = element_text(face = "bold")
  )

#Moderation Models: Does the assocaition between ADI and R1 differ depending DTS score? 
gam(lh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + ADI_NATRANK*DTS_Total, method = "REML", data = dts_hr4) 

gam(rh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + ADI_NATRANK*DTS_Total, method = "REML", data = dts_hr4) 
```

9) WRITE OUT
hr1_demo will be for aim1 and aim2 (239 obs.) & dts_hr4 will be for aim3 (226 obs.)
```{r}
write.csv(dts_hr4, file = "dts_df_am.csv", row.names = TRUE)
write.csv(hr1_demo, file = "hr1_df_am.csv", row.names = TRUE)
```

10) DEVELOPMENTAL AND ENVIRONMENTAL MODELS + DANS FIGURES
```{r}
### NOTES ###
#| Term                   | Linear? | Description                            |
#| ---------------------- | ------- | -------------------------------------- |
#| `s(age, k = 4)`        | no      | A smooth, nonlinear effect of age      |
#| `s(lunaid, bs = "re")` | no      | A random effect (also nonlinear)       |
#| `DTS_Total`            | yes     | A linear effect of dts |
# EDF (estimated degrees of freedom) -- how wiggly/complex the smooth curve of model 
  # if edf = 1 then smooth term behaves like a striaght line (linear effect)
  # if edf > 1 then relationship is nonlinear (more curvature)
#F STAT tests significance - how strong/significant is the effect?
  # higher F stats: smooth term fits data well & has meaningful effect 
#P VALUE is statistical significance 
#Estimate = the unstandardized beta coefficient (β)

### NEW READ INS ###
dts_hr4 <- read.csv("hr1_df_am.csv")
dts_mod <- read.csv("dts_df_am.csv")

### BASIC MODELING ###
dts_mod$lunaid <- as.factor(dts_mod$lunaid)

#Developmental Model: How does R1 change (non-linearly) with age?
model.dev.am.lh <- gam(lh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re"), method = "REML", data = dts_mod)
model.dev.am.rh <- gam(rh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re"), method = "REML", data = dts_mod)
summary(model.dev.am.lh)
summary(model.dev.am.rh)

#at what ages is the relationship significantly changing? 
library(ggeffects)
model.prediction.age.lh <- predict_response(model.dev.am.lh, terms = c("age"))
model.prediction.age.rh <- predict_response(model.dev.am.rh, terms = c("age"))
plot(model.prediction.age.lh)
plot(model.prediction.age.rh)

#Developmental Derivatives 
# calculating derivatives of the age spline (the age trajectory) will give us an instantaneous slope at each age and help us see at what ages the change in R1 is statistically significant #
library(gratia)

### DANS FIGURES -- AIM 1: DEVELOPMENTAL ###
draw(model.dev.am.lh, select = 1) + ggtitle("Left Hippocampus R1 ~ Age")
draw(model.dev.am.rh, select = 1) + ggtitle("Right Hippocampus R1 ~ Age")

# creating smooth plot for left hemisphere#
p_lh <- draw(model.dev.am.lh, select = 1, 
             col = "#1f78b4",
             fill = "#a6cee3") +
  ggtitle("Left Hippocampus") +
  labs(x = "Age (years)", y = "R₁ value") +
  theme_classic(base_size = 16, base_family = "Times New Roman") +
  theme(
    plot.title = element_text(face = "bold"),
    axis.title = element_text(face = "bold")
  )
print(p_lh)

# creating smooth plot for right hemisphere #
p_rh <- draw(model.dev.am.rh, select = 1) +
  ggtitle("Right Hippocampus") +
  labs(x = "Age (years)", y = "R₁ value") +
  theme_classic(base_size = 16, base_family = "Times New Roman") +
  theme(
    plot.title = element_text(face = "bold"),
    axis.title = element_text(face = "bold")
  )
print(p_rh)

#Environmental Models: What is the relationship between ADI and R1, controlling for age differences in R1?
model.adi.am.lh <- gam(lh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + ADI_NATRANK, method = "REML", data = dts_mod)
model.adi.am.rh <- gam(rh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + ADI_NATRANK, method = "REML", data = dts_mod)
summary(model.adi.am.lh)
summary(model.adi.am.rh)

#Moderation Models: Does the association between ADI and R1 differ depending DTS score? 
# TOTAL DTS SCORE - adi interaction #
model.mod.am.lh <- gam(lh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + ADI_NATRANK*DTS_Total, method = "REML", data = dts_mod) 
model.mod.am.rh <- gam(rh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + ADI_NATRANK*DTS_Total, method = "REML", data = dts_mod) 
summary(model.mod.am.lh)
summary(model.mod.am.rh)

#Moderation Model of subdomains
# TOLERANCE #
model.tol.am.lh <- gam(lh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + ADI_NATRANK*DTS_Tolerance, method = "REML", data = dts_mod) 
model.tol.am.rh <- gam(rh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + ADI_NATRANK*DTS_Tolerance, method = "REML", data = dts_mod) 
summary(model.tol.am.lh)
summary(model.tol.am.rh)

# ABSORB #
model.abs.am.lh <- gam(lh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + ADI_NATRANK*DTS_Absorb, method = "REML", data = dts_mod) 
model.abs.am.rh <- gam(rh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + ADI_NATRANK*DTS_Absorb, method = "REML", data = dts_mod) 
summary(model.abs.am.lh)
summary(model.abs.am.rh)

# APPRAISE #
model.app.am.lh <- gam(lh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + ADI_NATRANK*DTS_Appraise, method = "REML", data = dts_mod) 
model.app.am.rh <- gam(rh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + ADI_NATRANK*DTS_Appraise, method = "REML", data = dts_mod) 
summary(model.app.am.lh)
summary(model.app.am.rh)

# SIDE QUEST # 

#THERE IS A NEGATIVE INTERACTION SO AS DTS APPRAISE INCREASES (worse tolerance) THE AFFECT ON ADI AND R1 BECOMES NEGATIVE OR WEAKER(?) Do people with better appraisal show STRONGER or WEAKER associations between R1 and ADI? 

# Get predicted values for ADI_NATRANK across low and high DTS_Appraise
pred2 <- ggpredict(model.app.am.rh, terms = c("ADI_NATRANK", "DTS_Appraise")) 

plot(pred2) + labs(
    title = "Moderation of ADI effect on hippocampal R1 by DTS_Appraise",
    x = "Neighborhood Disadvantage",
    y = "Predicted hippocampal R1",
    color = "DTS Appraise"
  )


### DANS FIGURE -- APPRAISAL MODERATION EFFECT ###
# creating the predictions 
pred3 <- ggpredict(
  model.app.am.rh,
  terms = c('ADI_NATRANK', 'DTS_Appraise [1,3,5]')
)

#renaming the factor levels
pred3$group <- factor(pred3$group,
                      levels = c("1", "3", "5"),
                      labels = c("High Tolerance", "Moderate Tolerance", "Low Tolerance"))

plot(pred3) + 
  labs(
    title = "Moderation effect by DTS Appraise",
    x = "Neighborhood Disadvantage",
    y = "Predicted hippocampal R1",
    color = "DTS Appraise") +
  theme_classic(base_size = 16, base_family = "Times New Roman") +
  theme(
    plot.title = element_text(face = "bold"),
    axis.title = element_text(face = "bold")
  )

# REGULATE #
model.reg.am.lh <- gam(lh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + ADI_NATRANK*DTS_Regulate, method = "REML", data = dts_mod) 
model.reg.am.rh <- gam(rh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + ADI_NATRANK*DTS_Regulate, method = "REML", data = dts_mod) 
summary(model.reg.am.lh)
summary(model.reg.am.rh)


### How does DTS predict R1 values? ###
# TOTAL DTS #
model.modR1.lh <- gam(lh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + DTS_Total, method = "REML", data = dts_mod)
model.modR1.rh <- gam(rh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + DTS_Total, method = "REML", data = dts_mod)
summary(model.modR1.lh)
summary(model.modR1.rh)

# TOLERANCE #
model.tolR1.lh <- gam(lh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + DTS_Tolerance,method = "REML", data = dts_mod)
model.tolR1.rh <- gam(rh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + DTS_Tolerance, method = "REML", data = dts_mod)
summary(model.tolR1.lh)
summary(model.tolR1.rh)

# ABSORB #
model.absR1.lh <- gam(lh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + DTS_Absorb, method = "REML", data = dts_mod)
summary(model.absR1.lh)

model.absR1.rh <- gam(rh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + DTS_Absorb, method = "REML", data = dts_mod)
summary(model.absR1.rh)

# APPRAISE #
model.appR1.lh <- gam(lh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + DTS_Appraise, method = "REML", data = dts_mod)
summary(model.appR1.lh)

model.appR1.rh <- gam(rh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + DTS_Appraise, method = "REML", data = dts_mod)
summary(model.appR1.rh)

# REGULATE #
model.regR1.lh <- gam(lh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + DTS_Regulate, method = "REML", data = dts_mod)
summary(model.regR1.lh)

model.regR1.rh <- gam(rh_hippocampus_R1 ~ s(age, k = 4) + s(lunaid, bs = "re") + DTS_Regulate, method = "REML", data = dts_mod)
summary(model.regR1.rh)


### DOES ADI PREDICT DTS SCORES? CONTROLLING FOR AGE  ###
# TOTAL DTS #
model.mod.ADI <- gam(DTS_Total~ s(age, k = 4) + s(lunaid, bs = "re") + ADI_NATRANK, method = "REML", data = dts_mod)
summary(model.mod.ADI)

# TOLERANCE #
model.tol.ADI <- gam(DTS_Tolerance ~ s(age, k = 4) + s(lunaid, bs = "re") + ADI_NATRANK, method = "REML", data = dts_mod)
summary(model.tol.ADI)

# ABSORB #
model.abs.ADI <- gam(DTS_Absorb ~ s(age, k = 4) + s(lunaid, bs = "re") + ADI_NATRANK, method = "REML", data = dts_mod)
summary(model.abs.ADI)

# APPRAISE #
model.app.ADI <- gam(DTS_Appraise ~ s(age, k = 4) + s(lunaid, bs = "re") + ADI_NATRANK, method = "REML", data = dts_mod)
summary(model.app.ADI)

# REGULATE #
model.reg.ADI <- gam(DTS_Regulate ~ s(age, k = 4) + s(lunaid, bs = "re") + ADI_NATRANK, method = "REML", data = dts_mod)
summary(model.reg.ADI)

```







